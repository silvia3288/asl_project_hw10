{% extends "layout.html" %}

{% block content %}

<h2>Learn: Greetings</h2>
<p>Choose a word or phrase below to start!</p>

<div id="greetings-container" class="d-flex flex-wrap justify-content-around"></div>


<form method="post" action="{{ url_for('greetings') }}" class="mt-3">
    <button type="submit" class="btn btn-primary">Complete Greetings Section</button>
</form>

<script>
    
    const serverSessionId = '{{ session_id }}';

    
    const storedSessionId = localStorage.getItem('sessionId');

    if (storedSessionId !== serverSessionId) {
        
        localStorage.clear();

        
        localStorage.setItem('sessionId', serverSessionId);
    }
    
    let greetings = {{ go_go|tojson|safe }};

    function displayGreetings(items) {
        const container = document.getElementById('greetings-container');
        container.innerHTML = '';
        items.forEach(item => {
            const buttonElement = document.createElement('button');
            buttonElement.className = 'greeting-btn btn btn-secondary m-1';
            buttonElement.innerText = item.name;

            
            if (localStorage.getItem(item.id) === 'visited') {
                buttonElement.classList.add('btn-success'); 
            }

            buttonElement.onclick = function () {
                localStorage.setItem(item.id, 'visited');
                buttonElement.classList.add('btn-success');
                window.location.href = "/view/" + item.id;
            };
            container.appendChild(buttonElement);
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        displayGreetings(greetings);
    });
</script>

{% endblock %}

